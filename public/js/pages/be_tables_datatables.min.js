/*!
 * dashmix - v5.2.0
 * @author pixelcave - https://pixelcave.com
 * Copyright (c) 2022
 */
Dashmix.onLoad(
    class {
        static initDataTables() {
            jQuery.extend(jQuery.fn.dataTable.ext.classes, { sWrapper: "dataTables_wrapper dt-bootstrap5", sFilterInput: "form-control", sLengthSelect: "form-select" }),
                jQuery.extend(!0, jQuery.fn.dataTable.defaults, {
                    language: {
                        lengthMenu: "_MENU_",
                        search: "_INPUT_",
                        searchPlaceholder: "Search..",
                        info: "Page <strong>_PAGE_</strong> of <strong>_PAGES_</strong>",
                        paginate: { first: '<i class="fa fa-angle-double-left"></i>', previous: '<i class="fa fa-angle-left"></i>', next: '<i class="fa fa-angle-right"></i>', last: '<i class="fa fa-angle-double-right"></i>' },
                    },
                }),
                jQuery.extend(!0, jQuery.fn.DataTable.Buttons.defaults, { dom: { button: { className: "btn btn-sm btn-secondary" } } })   
                jQuery(".js-dataTable-buttons").DataTable({
                    pageLength: 10,
                    lengthMenu: [
                        [5, 10, 20],
                        [5, 10, 20],
                    ],
                    autoWidth: !1,
                    bInfo: false,
                    bFilter: false,
                    buttons: ["copy", "csv", "excel", "pdf", "print"],
                    dom: "<'row'<'col-sm-12'<'text-end py-2 mb-2'B>>><'row'<'col-sm-12 col-md-6'l><'col-sm-12 col-md-6'f>><'row'<'col-sm-12'tr>><'row'<'col-sm-12 col-md-5'i><'col-sm-12 col-md-7'p>>",
                    responsive: true,
                    pagingType: "simple_numbers",
                    processing: true,
                    serverSide: true,
                    type: "GET",
                    ajax: {
                        url: "/" + window.location.href.split("/").pop() + "/list",
                        type: 'GET',
                        data: function (d) {
                            d.custom_search = $('#custom_search').val();
                        }
                    },
                    columns: this.columns()
                }),
                jQuery( "#custom_search" ).keyup(function() {
                    if (jQuery(this).val().length >= 3 || jQuery(this).val().length == 0) {
                        jQuery('.js-dataTable-buttons').DataTable().draw(true);
                    }
                });
        }
        static init() {
            this.initDataTables();
        }
        static columns() {
            let listType = window.location.href.split("/").pop();
            let data = [];
            switch (listType) {
                case 'residents':
                    data = [
                        {data: "profile_picture","name":"profile_picture",orderable:false,searchable:false,"width":"8%", className:"v-align text-center",
                        "render": function (data) {
                            return "<center><div><img src='" + data + "' alt='Image' height='40' width='40' class='rounded-circle'></div></center>";
                        }},
                        {data: "name", 'name' :"name","width":"50%"},
                        {data: "birth_date", 'name' :"birth_date","width":"30%"},
                        {data: "id", "name": "id", orderable:false, searchable:false, "render": function (data, type, row, meta) {
                            return '<div class="btn-group">'+
                                        '<a href="/residents/'+data+'" class="btn btn-sm btn-alt-secondary js-bs-tooltip-enabled" data-bs-toggle="tooltip" title="" data-bs-original-title="Edit">'+
                                        '<i class="fa fa-fw fa-eye"></i>'+
                                        '</a>'+
                                        '<a href="/residents/create" class="btn btn-sm btn-alt-secondary js-bs-tooltip-enabled" data-bs-toggle="tooltip" title="" data-bs-original-title="Edit">'+
                                        '<i class="fa fa-pencil-alt"></i>'+
                                        '</a>'+
                                        '<a href="#" class="btn btn-sm btn-alt-secondary js-bs-tooltip-enabled" data-bs-toggle="tooltip" title="" data-bs-original-title="Delete">'+
                                        '<i class="fa fa-fw fa-times text-danger"></i>'+
                                        '</a>'+
                                    '</div>';
                        }}
                    ];
                    break;
            
                default:
                    break;
            }

            return data;
        }
    }.init()
);
